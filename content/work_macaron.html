<div id="content" class="content_work_category macaron">

	<div class="wrapper">
		<!-- title box -->
		<div class="entryBox first">
			<div class="textWrap">
				<p class="title font_color_light">馬卡龍</p>
				<p class="text font_color_light">
					馬卡龍禮盒正式開賣!!!<br/>
					即日起至2013結束以前，替<a href="https://www.facebook.com/lavieenvanille" target="_blank">香草生活粉絲專頁</a>按讚的朋友們均可享85折優惠唷!!宅配單筆滿3000元另可享免運優惠!!!!
				</p>
			</div>
		</div>

		<!-- insert canvas items(javascript) -->
		<div class="insertItemCanvas"></div>

		<!-- link to index -->
		<div id="link_content_work_macaron_last" class="entryBox last">
			<p class="last font_color_light">回目錄</p>
		</div>
	</div>


	<!-- lightbox for click items -->
	<div class="lightboxBackground" >
	</div>
	<div class="lightbox">
		<div class="lightboxWrapper">
			<img class="itemImg" alt="馬卡龍">
			<!--<img class="ico_cross" src="./images/ico_cross.png" style="width:2rem" alt="ico_cross">-->
			<p>
				最近剛好都走棒棒糖路線!<br/>
				這是幫好友精心設計的婚禮小點~<br/>
				無論口味or配色 自已都很喜歡，<br/>
				殊不知..放個包包回來...就被拿光光了!! <br/>
				都還來不及好好拍張照呢!! <br/>
			</p>
		</div>
	</div>


	<!-- 
	javascript for
		1. cropped images
		2. link to page of index
		3. hover animation
	-->
	<script>
		$(document).ready(function(){

			/*-----------------------------------------------------
			NEED TO INPUT INFORMATION OF CATEGORY
			-----------------------------------------------------*/
			var numberCanvas      = 13;                               //number of items
			var itemImagePosition = "./images/work/macaron/";         //images in which fold
			var itemNamePrefix    = "macaron_";                       //the prefix for image ex: "macaron_1.jpg"  =>  prefix: "macaron_"

			/* ID name for the canvas. it must be unique name in this website. */
			var IDcanvas          = function(Xindex){                 
				return "canvas_content_work_macaron_" + Xindex ;
			};

			/* input the ID of last entryBox for link to index */
			$().clickLinkContent( '#link_content_work_macaron_last', filePosition, 'work' );
			/*---------------------------------------------------*/


			/*---------------------
			insert canvas items
			-----------------------*/
			for(var i = 1; i <= numberCanvas; i++) {
				$('.insertItemCanvas').append('<canvas id="' + IDcanvas(i) + '">' + itemNamePrefix + i + '</canvas>');
			};


			/*---------------------
			define the size of canvas equal to the size of last entryBox (unit: px)
			-----------------------*/
			var sizeCanvas = Number();
			sizeCanvas = +$('#content .content_work_category .entryBox.last').css("height").toLowerCase().replace("px", "");


			/*---------------------
			setup canvas (ref: http://www.html5canvastutorials.com/tutorials/html5-canvas-image-crop)
			-----------------------*/
			/* declare array of objects for canvas cropping image */
			var objArrayCanvas = new Array();
			for (var i = 1; i <= numberCanvas; i++) objArrayCanvas.push( new Object() );
			/* start setup */
			for (var i = 1; i <= numberCanvas; i++) {
				objArrayCanvas[i]        = new Image();
				objArrayCanvas[i].index  = i;
				objArrayCanvas[i].onload = function() {
					var tempCanvas = document.getElementById( IDcanvas(this.index) );
					    tempCanvas.width  = sizeCanvas;
					    tempCanvas.height = sizeCanvas;
					/* draw cropped image */
					var reduceRatio  = 2.5;
					var sourceWidth  = this.width  / reduceRatio;
					var sourceHeight = this.height / reduceRatio;
					var sourceX = -(sourceWidth  - tempCanvas.width)/2;
					var sourceY = -(sourceHeight - tempCanvas.height)/2;
					tempCanvas.getContext('2d').drawImage(objArrayCanvas[this.index], sourceX, sourceY, sourceWidth, sourceHeight);
				};
				objArrayCanvas[i].src = itemImagePosition + itemNamePrefix + i + '.jpg';  //filePosition and fileName
			};


			/*---------------------
			lightbox switch for each item
			-----------------------*/
			for (var i = 1; i <= numberCanvas; i++) {
				$( '#' + IDcanvas(i) ).click(function(){
					/* insert images for lightbox */
					var $imgID      = $('.lightbox .lightboxWrapper img.itemImg');   // DOMid for jquery
					var imgFileName = itemNamePrefix + this.id.slice( this.id.lastIndexOf("_")+1, this.id.length );
					$imgID[0].src= itemImagePosition + imgFileName + ".jpg";         // input file position

					/* dynamically change image size */
					var imgWidth    = Number();                       // image width  for lightbox
					var imgHeight   = Number();                       // image height for lightbox
					if ( $imgID[0].width > $imgID[0].height ) {
						imgWidth  = 35 * fontSizePx;
						imgHeight = imgWidth / $imgID[0].width * $imgID[0].height;
					} else{
						imgHeight = 30 * fontSizePx;
						imgWidth  = imgHeight / $imgID[0].height * $imgID[0].width;
					};
					$imgID.height( imgHeight );
					$imgID.width(  imgWidth  );

					/* lightbox turnOn */
					$('.lightboxBackground, .lightbox').fadeIn(150);
				});
			};
			/* lightbox turnOff */
			$('.lightboxBackground').click(function(){
				$('.lightboxBackground, .lightbox').fadeOut(150);
			});


			/*---------------------
			hover animation
			-----------------------*/
			$("#content.content_work_category canvas").hover(function(){
				$(this).stop;
				$(this).animate({"border-radius":"2.125rem" },{duration:100,queue:false});
				return false;
			}, function(){
				$(this).animate({"border-radius":"0.5rem"},{duration:100,queue:false});
				return false;
			});
			$("#content.content_work_category .entryBox.last").hover(function(){
				$(this).stop;
				$(this).animate({
					"border-top-left-radius"   :"2.125rem",
					"border-bottom-left-radius":"2.125rem" 
				},{duration:100,queue:false});
				return false;
			}, function(){
				$(this).animate({
					"border-top-left-radius"   :"0.5rem",
					"border-bottom-left-radius":"0.5rem" 
				},{duration:100,queue:false});
				return false;
			});


		});
	</script>
	
</div>